# 🔀 分支合併指南

**負責人**: 蔡易霖 (C組組長)  
**更新**: 2025-08-20

## 📊 分支架構
```
main (生產)
├── dev (開發)
    ├── feature/A組 (會員認證)
    ├── feature/B組 (商品分類)
    ├── feature/C組 (訂單金流)
    ├── feature/D組 (優惠券)
    └── feature/E組 (客服評價)
```

## 🎯 合併順序
1. **A組** → dev (會員基礎)
2. **B組** → dev (商品資料)
3. **C組** → dev (訂單交易)
4. **D組** → dev (優惠整合)
5. **E組** → dev (客服功能)
6. **dev** → main (正式發布)

---

## 🔄 合併流程

### 準備工作
```bash
git fetch --all
git checkout dev
git pull origin dev
```

### 逐組合併
```bash
# 檢查該組進度
git log --oneline origin/feature/A組 -5

# 合併到 dev
git merge origin/feature/A組 --no-ff -m "merge(A組): 整合會員認證系統"

# 測試功能
npm run type-check
npm run build
npm run dev

# 推送結果
git push origin dev
```

### 常用合併訊息範本
```bash
# A組
"merge(A組): 整合會員認證系統"

# B組  
"merge(B組): 整合商品分類系統"

# C組
"merge(C組): 整合訂單金流物流系統"

# D組
"merge(D組): 整合優惠券促銷系統"

# E組
"merge(E組): 整合客服評價系統"
```

## 🛠️ 衝突處理

### 常見衝突檔案
- `src/router/index.ts` - 路由重複
- `src/components/layout/NavBar.vue` - 導航選單
- `src/api/http.ts` - API 設定
- `src/assets/main.css` - 樣式衝突

### 解決步驟
```bash
# 1. 查看衝突
git status

# 2. 手動編輯衝突檔案 (找到 <<<< >>>> 標記)

# 3. 解決後
git add 檔案名
git commit -m "resolve: 解決X組與Y組衝突"
```

## 🧪 測試清單

### 每組合併後檢查
- [ ] `npm run type-check` 通過
- [ ] `npm run build` 成功
- [ ] 該組核心功能正常
- [ ] 與前面組別整合無問題

### 關鍵整合測試
- **A組後**: 註冊、登入
- **B組後**: 登入→瀏覽商品
- **C組後**: 登入→商品→購物車→結帳→付款
- **D組後**: 優惠券套用到訂單
- **E組後**: 完整用戶體驗流程

## 🚀 發布到 main

```bash
# 最終測試
git checkout dev
npm run type-check && npm run build

# 合併到 main
git checkout main
git pull origin main
git merge dev --no-ff -m "release: v1.0.0 BUY電商平台完整功能發布

- ✅ 五組功能完整整合
- ✅ 所有測試通過  
- 🚀 Ready for Production"

git push origin main

# 建立版本標籤
git tag -a v1.0.0 -m "BUY電商平台 v1.0.0"
git push origin v1.0.0
```

## 🆘 緊急處理

### 回滾合併
```bash
git checkout dev
git reset --hard HEAD~1
git push origin dev --force-with-lease
```

### 團隊通知範本
```
🔄 準備合併 X組到 dev
⏰ 時間: XX:XX
🚫 請暫停推送 dev 分支

✅ X組合併完成  
🔄 請同步: git pull origin dev
```

## ⚡ 快速指令

```bash
# 檢查進度
git log --oneline origin/feature/組名 -5

# 標準合併
git checkout dev
git pull origin dev  
git merge origin/feature/組名 --no-ff -m "訊息"
npm run type-check && git push origin dev

# 查看差異
git log dev..origin/feature/組名 --oneline
```

---

**重要提醒**:
- ✅ 每次合併前先 pull dev
- ✅ 使用 `--no-ff` 保留歷史  
- ✅ 測試通過才推送
- ❌ 不要跳過測試步驟